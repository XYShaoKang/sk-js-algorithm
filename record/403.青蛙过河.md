# 403.é’è›™è¿‡æ²³

```ts
/*
 * @lc app=leetcode.cn id=403 lang=typescript
 *
 * [403] é’è›™è¿‡æ²³
 */

// @lc code=start
function canCross(stones: number[]): boolean {}
// @lc code=end
```

## è§£æ³• 1: åŠ¨æ€è§„åˆ’

- æ—¶é—´å¤æ‚åº¦: <!-- $O(n^2)$ --> <img style="transform: translateY(0.1em); background: white;" src="./svg/o-n-power-2.svg" alt="O(n^2)">
- ç©ºé—´å¤æ‚åº¦: <!-- $O(n^2)$ --> <img style="transform: translateY(0.1em); background: white;" src="./svg/o-n-power-2.svg" alt="O(n^2)">

1. å­é—®é¢˜: èƒ½è·³è·ƒåˆ°å½“å‰çŸ³å­çš„çŸ³å­ä¸å½“å‰çŸ³å­çš„è·ç¦»æ˜¯å¤šå°‘
2. çŠ¶æ€:
   - `dp[i][j]` è¡¨ç¤ºä¸Šä¸ªçŸ³å­åˆ°å½“å‰çŸ³å­çš„è·ç¦»
3. DP æ–¹ç¨‹: ä»å½“å‰çŸ³å­éå†å½“å‰çŸ³å­èƒ½è·³è·ƒåˆ°çš„ä¸‹ä¸ªçŸ³å­,å¹¶å°†è·ç¦»æ·»åŠ åˆ°ä¸‹ä¸ªçŸ³å­
   - n è¡¨ç¤ºä¸‹ä¸€ä¸ªçŸ³å­çš„ä½ç½®
   - k è¡¨ç¤ºåˆ°ä¸‹ä¸€ä¸ªçŸ³å­çš„è·ç¦»
   - `dp[n][k]=dp[i][k-1] || dp[i][k] || dp[i][k+1]`
4. è¾¹ç•Œ:
   - `dp[0]=[0]`

> ä¸€è·¯ä» 2000ms ä¼˜åŒ–åˆ° 400ms,è¿˜æ˜¯åªå‡»è´¥äº† 8.33% çš„æäº¤,æ˜¯è¿™é¢˜åŠ¨æ€è§„åˆ’çš„æé™äº†ä¹ˆ ğŸ˜‚

```ts
function canCross(stones: number[]): boolean {
  const dp: { [key: number]: Set<number> } = { 0: new Set([0]) }
  for (let i = 0; i < stones.length - 1; i++) {
    const si = stones[i]
    if (!dp[si] || !dp[si].size) continue

    for (let j = i + 1; j < stones.length; j++) {
      const sj = stones[j]
      const k = sj - si
      if (!dp[sj]) dp[sj] = new Set()
      if (k > si + 1) break

      if (dp[si].has(k) || dp[si].has(k - 1) || dp[si].has(k + 1)) {
        if (j === stones.length - 1) return true

        dp[sj].add(k)
      }
    }
  }

  return false
}
```

## è§£æ³• 2: åŠ¨æ€è§„åˆ’ - ä¼˜åŒ–

- æ—¶é—´å¤æ‚åº¦: <!-- $O(n^2)$ --> <img style="transform: translateY(0.1em); background: white;" src="./svg/o-n-power-2.svg" alt="O(n^2)">
- ç©ºé—´å¤æ‚åº¦: <!-- $O(n^2)$ --> <img style="transform: translateY(0.1em); background: white;" src="./svg/o-n-power-2.svg" alt="O(n^2)">

1. å­é—®é¢˜: èƒ½è·³è·ƒåˆ°å½“å‰çŸ³å­çš„çŸ³å­ä¸å½“å‰çŸ³å­çš„è·ç¦»æ˜¯å¤šå°‘
2. çŠ¶æ€:
   - `dp[i]` è¡¨ç¤ºä¸Šä¸ªçŸ³å­åˆ°å½“å‰çŸ³å­çš„è·ç¦»çš„é›†åˆ
3. DP æ–¹ç¨‹:
   - n è¡¨ç¤ºä¸‹ä¸€ä¸ªçŸ³å­çš„ä½ç½®
   - k è¡¨ç¤ºèƒ½åˆ°å½“å‰çŸ³å­çš„è·ç¦»
   - `dis in [k-1,k,k+1], n = dis + stones[i]`
   - `if(n in stones) dp[n].add(dis)`
4. è¾¹ç•Œ:
   - `dp[0]=[0]`

è§£æ³• 1 ä¸­å»éå† i ä¹‹åçš„æ‰€æœ‰æ•°å­—,å…¶å®å½“å‰çŸ³å­èƒ½è·³è·ƒåˆ°çš„çŸ³å­,åªè¦æ ¹æ®å½“å‰çŸ³å­æ‰€åŒ…å«çš„è·ç¦»å»è®¡ç®—å³å¯,æ¯”å¦‚å½“å‰çŸ³å­åŒ…å«äº†`[2]`ä¸€ç§è·ç¦»,é‚£å½“å‰çŸ³å­èƒ½åˆ°è¾¾çš„ä¸‹ä¸ªçŸ³å­,å°±åªèƒ½æ˜¯`stones[i]`åŠ ä¸Š`[2-1,2,2+1]`è¿™ä¸‰ç§å¯èƒ½,å°†å¯¹åº”çš„è·ç¦»æ·»åŠ åˆ°å¯¹åº”çš„çŸ³å­ä¸Šå³å¯.

è™½ç„¶æœ€åçš„æƒ…å†µæ—¶é—´å¤æ‚åº¦è·Ÿè§£æ³• 1 ç›¸åŒ,ä½†å®é™…ä¸Šçœæ‰äº†å¾ˆå¤šä¸å¿…è¦çš„è®¡ç®—.æ—¶é—´èƒ½åˆ° 100ms å·¦å³,å‡»è´¥ 83% çš„æäº¤,è¿™ä¸ªç»“æœå°±å¯ä»¥æ¥å—äº†.

```ts
function canCross(stones: number[]): boolean {
  if (stones[1] !== 1) return false
  const dp = new Map(stones.map((s, i) => [s, new Set(i === 0 ? [0] : [])]))
  const end = stones[stones.length - 1]

  for (let i = 0; i < stones.length; i++) {
    const stone = stones[i]

    for (const distance of dp.get(stone)!) {
      for (const dis of [distance - 1, distance, distance + 1]) {
        if (dis < 0) continue // åªä¼šå¾€åè·³
        if (end === dis + stone) return true // èƒ½è·³åˆ°æœ€åä¸€ä¸ªçŸ³å­,ç›´æ¥è¿”å› true
        const j = dp.get(stone + dis)
        if (j) j.add(dis)
      }
    }
  }

  return false
}
```

## Case

```ts
test.each([
  { input: { stones: [0, 1, 3, 5, 6, 8, 12, 17] }, output: true },
  { input: { stones: [0, 1, 2, 3, 4, 8, 9, 11] }, output: false },
])(`input: stones = $input.stones`, ({ input: { stones }, output }) => {
  expect(canCross(stones)).toBe(output)
})
```
